---
- name: Configurar ambiente Kafka
  hosts: all
  gather_facts: yes
  become: yes
  become_user: root
  remote_user: root
  tasks:
    - name: Incluir tareas para configuraci√≥n de Kafka
      include_tasks: kafka/setup.yml
  tags: 
    - always

- name: Create Connectors properties
  hosts: all
  gather_facts: true
  any_errors_fatal: false 
  become: yes
  become_user: root   
  remote_user: root
  roles:
    - add_connectors
  tags: 
    - add-connectors

- name: Crear topicos
  hosts: all
  gather_facts: yes
  become: yes
  become_user: root
  remote_user: root
  tasks:
    - name: Incluir tareas para crear topicos de Kafka
      include_tasks: kafka/add_topics.yml
  tags: 
    - "apply-topic"

- name: Aplicando connect
  hosts: all
  gather_facts: true
  any_errors_fatal: false
  become: yes
  become_user: root
  remote_user: root
  roles:
    - apply_connect
  tags: 
    - apply-connect


- name: Nuke Topicos & Connectors
  hosts: all
  gather_facts: true
  any_errors_fatal: false
  become: yes
  become_user: root
  remote_user: root
  roles:
    - delete_topics
#    - delete_connectors
  tags: 
    - delete

