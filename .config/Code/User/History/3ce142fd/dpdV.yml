- name: "Creando directorio config/{{ ambiente }}"
  file:
    path: "{{ kafka_config_directory }}/{{ ambiente }}"
    state: directory

- name: Incluir variables espec√≠ficas del ambiente
  include_vars:
    file: "{{ playbook_dir }}/vars/{{ ambiente }}.yml"

- name: Copy propiedades generales
  template:
    src: "{{ repo_home }}/Ansible/templates/connect-distributed.properties.j2"
    dest: "{{ kafka_config_directory }}/{{ ambiente }}/connect-distributed.properties"

- name: Copy plugin
  copy:
    src: "{{ repo_home }}/utils/"
    dest: "{{ kafka_plugin_directory }}"
    mode: 775

- name: Copy configs
  copy:
    src: "{{ kafka_connectors_dir }}"
    dest: "{{ kafka_config_directory }}/{{ ambiente }}"
    mode: 775

- name: Ejecutar scripts de conectores para cada entorno
  shell: |
    nohup sh {{ kafka_bin_directory }}/connect-distributed.sh {{ ambiente }}/connect-distributed.properties &